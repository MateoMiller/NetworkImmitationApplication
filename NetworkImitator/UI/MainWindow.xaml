<Window x:Class="NetworkImitator.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:networkComponents="clr-namespace:NetworkImitator.NetworkComponents"
        xmlns:ui="clr-namespace:NetworkImitator.UI"
        Title="Graph App" Height="600" Width="1200">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="200"/>
            <ColumnDefinition Width="250"/>
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Column="1">
            <Button Content="Добавить компьютер" Command="{Binding AddClientCommand}"/>
            <Button Content="Добавить сервер" Command="{Binding AddServerCommand}"/>
            <Button Content="Добавить балансировщик нагрузки" Command="{Binding AddLoadBalancerCommand}"/>
            <Button Content="Добавить ребро" Command="{Binding AddConnectionCommand}"/>

        </StackPanel>
    
        <Canvas Name="ComponentsCanvas" Grid.Column="0" Background="LightGray" MouseMove="OnCanvasMouseMove">
            <ItemsControl ItemsSource="{Binding Components}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <Canvas />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemContainerStyle>
                    <Style TargetType="ContentPresenter">
                        <Setter Property="Canvas.Left" Value="{Binding X}"/>
                        <Setter Property="Canvas.Top" Value="{Binding Y}"/>
                    </Style>
                </ItemsControl.ItemContainerStyle>
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="{x:Type networkComponents:Component}">
                        <ui:ComponentControl Component="{Binding }" />
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>       
        </Canvas>
        
        <StackPanel Grid.Column="2" Margin="10">
            <TextBlock Text="Настройки компонента" FontWeight="Bold" FontSize="16"/>
            <ContentControl Content="{Binding SelectedComponent}">
                <ContentControl.Resources>
                    <DataTemplate x:Key="CommonIPAddressTemplate">
                        <StackPanel>
                            <TextBlock Text="IP адрес"/>
                            <TextBox Text="{Binding IP, UpdateSourceTrigger=PropertyChanged}" IsEnabled="False" />
                            <TextBlock Text="Имя компонента"/>
                            <TextBox Text="{Binding DeviceName, UpdateSourceTrigger=PropertyChanged}" />
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate DataType="{x:Type networkComponents:Client}">
                        <StackPanel>
                            <TextBlock Text="Период отправки пакетов:"/>
                            <TextBox Text="{Binding SendingPacketPeriod, UpdateSourceTrigger=PropertyChanged}" />
                            <ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource CommonIPAddressTemplate}" />
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate DataType="{x:Type networkComponents:Server}">
                        <StackPanel>
                            <TextBlock Text="Время обработки:"/>
                            <TextBox Text="{Binding TimeToProcessMs, UpdateSourceTrigger=PropertyChanged}" />
                            <ContentPresenter Content="{Binding}" ContentTemplate="{StaticResource CommonIPAddressTemplate}" />
                        </StackPanel>
                    </DataTemplate>
                </ContentControl.Resources>
            </ContentControl>
        </StackPanel>
    </Grid>
</Window>